@model EgyptianRecipes.Models.Request.BookingBranch

<!-- Booking Branch Modal -->
<div class="modal fade" id="BookingBranchModal" tabindex="-1" aria-labelledby="BookingBranchModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="BookingBranchLabel">Booking <span id="branchTitle"></span> Branch </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">

                <form id="modalForm" method="post" action="/Branches/BookBranch">
                    @using (Html.BeginForm("BookBranch", "Branch", FormMethod.Post, new { @id = "BookBranch" }))
                    {
                        @Html.HiddenFor(c => c.branchId, new { @id = "itemId" })
                        <div class="form-group ">
                            @Html.LabelFor(m => m.clientName, "Name", new { @class = "col-form-label" })
                            @Html.TextBoxFor(m => m.clientName, new { @class = "form-control", @id = "clientName" })
                            <span asp-validation-for="clientName" class="text-danger"></span>
                        </div>
                        <div class="form-group ">
                            @Html.LabelFor(m => m.clientPhone, "Phone", new { @class = "col-form-label" })
                            @Html.TextBoxFor(m => m.clientPhone, new { @class = "form-control", @id = "clientPhone" })
                            <span asp-validation-for="clientPhone" class="text-danger"></span>
                        </div>
                        <div class="form-group ">
                            @Html.LabelFor(m => m.clientEmail, "Email", new { @class = "col-form-label" })
                            @Html.TextBoxFor(m => m.clientEmail, new { @class = "form-control", @id = "clientEmail" })
                            <span asp-validation-for="clientEmail" class="text-danger"></span>
                        </div>
                        <div class="form-group ">
                            @Html.LabelFor(m => m.note, "Note", new { @class = "col-form-label" })
                            @Html.TextBoxFor(m => m.note, new { @class = "form-control", @id = "note", @type = "text" })
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                            <button type="submit" class="btn btn-primary">Book</button>

                        </div>
                    }
                </form>


            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/jquery.validate.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation-unobtrusive@3.2.12/dist/jquery.validate.unobtrusive.min.js"></script>

<script>
    $(document).ready(function () {
        $('.open-modal').on('click', function () {
            var itemId = $(this).data('id');
            $('#itemId').val(itemId); // Set the value of the hidden input
            $('#BookingBranchModal').modal('show'); // Show the modal
        });

        $('#modalForm').on('submit', function (event) {
            event.preventDefault(); // Prevent the default form submission

            $.ajax({
                url: 'BookBranch',
                type: 'POST',
                data: $(this).serialize(),
                success: function (response) {
                    if (response.success) {
                        // Redirect to the specified URL
                        window.location.href = response.redirectUrl;
                    } else {
                        // Replace the modal content with the partial view containing validation errors
                        $('#BookingBranchModal .modal-content').html(response);
                    }
                }
            });
        });
    });
</script>


